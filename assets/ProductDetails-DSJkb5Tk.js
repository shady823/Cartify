import{n as q,r as g,o as A,e as S,c as b,j as r,L as I,m as P,p as i,B as E,q as F,s as Q,z as t,t as z,w as f}from"./index-DqMWGEfX.js";import{u as B,p as D}from"./useWishlistIds-C2W9zeNn.js";import{S as d}from"./Skeleton-xxPTFTLQ.js";function R(){const{id:a}=q(),[n,m]=g.useState(1),[x,j]=g.useState(0),u=A(),y=B(),s=a?y.includes(a):!1,{data:h,isLoading:N,error:w}=S({queryKey:["product",a],queryFn:()=>D.getById(a).then(o=>o.data.data),enabled:!!a}),v=b({mutationFn:()=>z.add(a,n),onSuccess:()=>{u.invalidateQueries({queryKey:["cart"]}),t.success("Added to cart")},onError:()=>t.error("Failed to add to cart")}),p=b({mutationFn:()=>s?f.remove(a):f.add(a),onSuccess:()=>{u.invalidateQueries({queryKey:["wishlist"]}),t.success(s?"Removed from wishlist":"Added to wishlist")},onError:()=>t.error("Something went wrong")});if(w||!a)return r.jsxs("div",{className:"mx-auto max-w-7xl px-4 py-16 text-center",children:[r.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:"Product not found."}),r.jsx(I,{to:"/products",className:"mt-4 inline-block text-indigo-600 dark:text-indigo-400 hover:underline",children:"Back to products"})]});if(N||!h)return r.jsx("div",{className:"mx-auto max-w-7xl px-4 py-8 sm:px-6 lg:px-8",children:r.jsxs("div",{className:"grid gap-8 lg:grid-cols-2",children:[r.jsx(d,{className:"aspect-square rounded-3xl"}),r.jsxs("div",{className:"space-y-4",children:[r.jsx(d,{className:"h-10 w-3/4"}),r.jsx(d,{className:"h-6 w-1/2"}),r.jsx(d,{className:"h-32 w-full"})]})]})});const e=h,l=e.images?.length?e.images:[e.imageCover],k=e.priceAfterDiscount??e.price,C=e.priceAfterDiscount!=null;return r.jsx(P.div,{initial:{opacity:0},animate:{opacity:1},className:"mx-auto max-w-7xl px-4 py-8 sm:px-6 lg:px-8",children:r.jsxs("div",{className:"grid gap-8 lg:grid-cols-2",children:[r.jsxs("div",{className:"space-y-4",children:[r.jsx("div",{className:"aspect-square overflow-hidden rounded-3xl border border-[var(--color-border)] dark:border-[var(--color-border)] bg-[var(--color-card)] dark:bg-[var(--color-card)]",children:r.jsx("img",{src:l[x]??e.imageCover,alt:e.title,decoding:"async",className:"h-full w-full object-cover"})}),l.length>1&&r.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2",children:l.map((o,c)=>r.jsx("button",{type:"button",onClick:()=>j(c),className:i("h-20 w-20 shrink-0 rounded-xl border-2 overflow-hidden transition-all",x===c?"border-[var(--color-primary)] ring-2 ring-[var(--color-primary)]/30":"border-[var(--color-border)] dark:border-[var(--color-border)] hover:border-[var(--color-muted)] dark:hover:border-[var(--color-muted-foreground)]"),children:r.jsx("img",{src:o,alt:"",loading:"lazy",decoding:"async",className:"h-full w-full object-cover"})},c))})]}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold text-[var(--color-foreground)]",children:e.title}),r.jsxs("p",{className:"mt-2 text-[var(--color-muted)] dark:text-[var(--color-muted-foreground)]",children:[e.category?.name," · ",e.brand?.name]}),r.jsxs("div",{className:"mt-6 flex items-center gap-4",children:[r.jsxs("span",{className:"text-3xl font-bold text-[var(--color-primary)] dark:text-[var(--color-primary)]",children:["EGP ",k]}),C&&r.jsxs("span",{className:"text-xl text-[var(--color-muted)] line-through",children:["EGP ",e.price]})]}),r.jsx("p",{className:"mt-6 text-[var(--color-muted)] dark:text-[var(--color-muted-foreground)] leading-relaxed",children:e.description}),r.jsxs("div",{className:"mt-8 flex flex-wrap items-center gap-4",children:[r.jsxs("div",{className:"flex items-center rounded-2xl border border-[var(--color-border)] dark:border-[var(--color-border)] overflow-hidden",children:[r.jsx("button",{type:"button",onClick:()=>m(o=>Math.max(1,o-1)),className:"h-12 w-12 flex items-center justify-center hover:bg-[var(--color-card-hover)] dark:hover:bg-[var(--color-card-hover)] transition-colors",children:"−"}),r.jsx("span",{className:"h-12 w-14 flex items-center justify-center font-medium border-x border-[var(--color-border)] dark:border-[var(--color-border)]",children:n}),r.jsx("button",{type:"button",onClick:()=>m(o=>Math.min(e.quantity,o+1)),className:"h-12 w-12 flex items-center justify-center hover:bg-[var(--color-card-hover)] dark:hover:bg-[var(--color-card-hover)] transition-colors",children:"+"})]}),r.jsxs(E,{variant:"primary",size:"lg",loading:v.isPending,onClick:()=>v.mutate(),className:"inline-flex items-center gap-2",children:[r.jsx(F,{className:"h-5 w-5"}),"Add to cart"]}),r.jsx("button",{type:"button",onClick:()=>p.mutate(),disabled:p.isPending,className:i("p-3 rounded-2xl border border-[var(--color-border)] dark:border-[var(--color-border)] hover:bg-[var(--color-card-hover)] dark:hover:bg-[var(--color-card-hover)] transition-colors",s&&"text-red-500 border-red-200 dark:border-red-900"),"aria-label":s?"Remove from wishlist":"Add to wishlist",children:r.jsx(Q,{className:i("h-5 w-5",s&&"fill-current")})})]})]})]})})}export{R as ProductDetails};
